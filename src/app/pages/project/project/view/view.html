<div class="project-view">

  <div class="content">
    <div class="row">
      <div class="list-toolbar col-xl-12">
        <div class="title">
          <span>{{project.name}}</span>
        </div>

        <div class="filter">

        </div>

        <div class="buttons">
          <button [routerLink]="['/pages/org/' + orgId + '/prjs']" type="button" class="btn btn-primary btn-with-icon btn-sm">
            <i class="fa fa-plus-circle"></i>返回
          </button>
        </div>
      </div>
    </div>

    <div class="row chart">
      <div class="col-sm-6">
        <design-progress [data]="chartData.design" [showTitle]="true"></design-progress>
      </div>
      <div class="col-sm-6">
        <execution-process [data]="chartData.exe" [showTitle]="true"></execution-process>
      </div>
    </div>

    <div class="row cards">
      <div class="col">
        <div class="card">
          <div class="card-header">
            测试计划
          </div>
          <div class="card-block">
            <table class="table">
              <thead class="thead-inverse">
              <tr>
                <th style="width: 200px">名称</th>
                <th style="width: 150px">计划开始时间</th>
                <th style="width: 150px">计划结束时间</th>
                <th style="width: 150px">状态</th>
                <th style="width: 150px">操作</th>
              </tr>
              </thead>

              <tbody>
              <tr *ngFor="let plan of plans; let i = index;">
                <td>{{plan.name}}</td>
                <td>{{plan.startTime | date:'y/MM/dd'}}</td>
                <td>{{plan.endTime | date:'y/MM/dd'}}</td>
                <td>{{plan.status | exeStatus}}</td>
                <td>
                  <span privilege [privs]="'test_plan-view'"
                        [routerLink]="['/pages/org/' + orgId + '/prj/' + id + '/implement/plan/' + plan.id + '/view']" class="link no-underline">查看</span>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="info">
    <div *ngIf="project.type=='project' && project.privs != null && project.privs['project-maintain']" class="manage">
      <div class="tabs-container light">
        <div class="tabs">
          <ngb-tabset  (tabChange)="tabChange($event)">
            <ngb-tab id="ver">
              <ng-template ngbTabTitle>版本</ng-template>
              <ng-template ngbTabContent></ng-template>
            </ngb-tab>
            <ngb-tab id="env">
              <ng-template ngbTabTitle>环境</ng-template>
              <ng-template ngbTabContent></ng-template>
            </ngb-tab>
            <ngb-tab id="user">
              <ng-template ngbTabTitle>用户</ng-template>
              <ng-template ngbTabContent></ng-template>
            </ngb-tab>
          </ngb-tabset>
        </div>
      </div>
      <div class="tab-bottom-space"></div>

      <div [class.hidden]="tab != 'ver'" class="project-manage">
        <div>
          <div class="item" *ngFor="let ver of vers; let i = index;">
            <div>{{ver.name}} 创建于{{ver.createTime | date:'y/MM/dd'}}</div>
          </div>
        </div>

        <div class="more">
              <span [routerLink]="['/pages/org/' + orgId + '/prjs/' +project.id+ '/edit/ver/list']"
                    class="link no-underline">更多</span>
        </div>
      </div>

      <div [class.hidden]="tab != 'env'" class="project-manage">
        <div>
          <div class="item" *ngFor="let env of envs; let i = index;">
            <div>{{env.name}} 创建于{{env.createTime | date:'y/MM/dd'}}</div>
          </div>
        </div>

        <div class="more">
              <span [routerLink]="['/pages/org/' + orgId + '/prjs/' +project.id+ '/edit/env/list']"
                    class="link no-underline">更多</span>
        </div>
      </div>

      <div [class.hidden]="tab != 'user'" class="project-manage">
        <div>
          <div class="item" *ngFor="let usr of users; let i = index;">
            <div>{{usr.nickname}} {{usr.createTime | date:'y/MM/dd'}}加入</div>
          </div>
        </div>

        <div class="more">
              <span [routerLink]="['/pages/org/' + orgId + '/prjs/' +project.id+ '/edit/member']"
                    class="link no-underline">更多</span>
        </div>
      </div>
    </div>

    <div class="activity">
      <div class="title">
        项目活动
      </div>
      <div class="list">
        <div *ngFor="let item of (histories | mapToArray); let i = index;" class="item">
          <div class="date">
            {{item.key}}
          </div>
          <div class="descr">
            <div class="action-html descr-item" *ngFor="let his of item.value; let j = index;">
              <div [innerHTML]="his.title" class="content"></div>&nbsp;&nbsp;
              <div class="date">{{his.createTime | date:'HH:mm:ss'}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
