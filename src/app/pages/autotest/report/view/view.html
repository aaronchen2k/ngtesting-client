<div *ngIf="model" class="report-view">

  <div class="edit-toolbar">
    <div class="title center">
      《{{model.name}}》- <span class="{{model.status}}">{{model.status}}</span>
    </div>
    <div class="buttons">
      <button [routerLink]="['/pages/report']" type="button"
              class="btn btn-secondary btn-with-icon btn-sm back">
        <i class="fa fa-arrow-circle-left"></i>返回
      </button>
    </div>
  </div>

  <table *ngFor="let suite of model.result.suites; let i=index;" class="table table-bordered table-striped">
    <thead class="thead-inverse">
    <tr>
      <th colspan="2">套件名称</th>
      <td colspan="6">{{suite.name}}</td>
    </tr>
    <tr>
      <th colspan="2">执行状态</th>
      <td class="{{suite.status}}" colspan="1">
        {{suite.status}}
      </td>
      <td colspan="5">
        用例数: {{suite.caseTotalCount}};
        通过数: {{suite.casePassCount}};
        失败数: {{suite.caseFailCount}};
        未运行: {{suite.caseSkippedCount}}
      </td>
    </tr>
    <tr>
      <th colspan="2">开始时间</th>
      <td colspan="6">{{suite.startTime | date:'y-MM-dd HH:mm:ss'}}</td>
    </tr>
    <!--         <tr>
                <th colspan="2">结束时间</th>
                <td colspan="6">{{suite.endTime | date:'y-MM-dd HH:mm:ss'}}</td>
            </tr> -->
    <tr>
      <th colspan="2">持续时间</th>
      <td colspan="6">{{suite.duration / 1000}} 秒</td>
    </tr>

    <tr>
      <td colspan="8"></td>
    </tr>
    <tr>
      <th style="width:50px;">编号</th>
      <th style="width:300px;">用例名称</th>
      <th>用例状态</th>
      <th>开始时间</th>
      <!-- <th>结束时间</th> -->
      <th>持续时间(秒)</th>
      <th>查看</th>
    </tr>
    </thead>
    <tbody>

    <tr *ngFor="let case of suite.cases let j=index;">
      <td>{{j + 1}}</td>
      <td>{{case.name}}</td>
      <td class="{{case.status}}">{{case.status}}</td>
      <td>{{case.startTime | date:'y-MM-dd HH:mm:ss'}}</td>
      <!-- <td>{{case.endTime | date:'y-MM-dd HH:mm:ss'}}</td> -->
      <td>{{case.duration / 1000}}</td>
      <td>
        <span class="link" (click)="pop(content, case, 'checkpoint')">检查点({{case.checkPoints.length}})</span>
        <span class="link" (click)="pop(content, case, 'log')">日志</span>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<ng-template #content let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">
      <span *ngIf="contentType == 'checkpoint'">检查点</span>
      <span *ngIf="contentType == 'log'">运行日志</span>
    </h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <ol *ngIf="contentType == 'checkpoint'">
      <li class="line"  *ngFor="let checkpoint of contentCase.checkPoints">
        <span [outerHTML]="(checkpoint.name + ' - ' + checkpoint.status) | markError"></span>
      </li>

      <div *ngIf="contentCase.checkPoints.length == 0">此用例未有执行检查点</div>
    </ol>

    <ol *ngIf="contentType == 'log'">
      <li class="line"  *ngFor="let log of contentCase.output">
        <span [outerHTML]="log | markError"></span>
      </li>
    </ol>
  </div>
</ng-template>
